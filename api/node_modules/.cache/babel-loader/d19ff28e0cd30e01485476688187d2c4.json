{"ast":null,"code":"var _templateObject,\n    _templateObject2,\n    _templateObject3,\n    _templateObject4,\n    _jsxFileName = \"/Users/diehl/Documents/Projects/icfc/app/javascript/src/components/charts/Index.js\";\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (typeof call === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nimport React, { Component } from 'react';\nimport { Breadcrumb, Table, FormControl, FormGroup } from 'react-bootstrap';\nimport styled from 'styled-components';\nimport BarLoader from 'react-spinners/BarLoader';\nimport { Link } from 'react-router-dom';\nimport * as moment from 'moment';\nimport * as axios from 'axios';\nvar CardWrapper = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n\"])));\nvar ChartForm = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n    margin: 0 auto;\\n    padding: 0px 33%;\\n\"])));\nvar ChartTable = styled.div(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n    margin-top: 12px;\\n\"])));\nvar Validator = styled.span(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n    text-size: 8px;\\n    margin: 7px;\\n\"])));\n\nfunction ChartList(props) {\n  var _this = this;\n\n  var fileName = function fileName(url) {\n    return url.split('/').slice(-1)[0];\n  };\n\n  var token = document.querySelector('meta[name=\"csrf-token\"]').content;\n\n  var deleteChart = function deleteChart(e, id) {\n    e.preventDefault();\n    axios({\n      method: 'delete',\n      url: \"/api/v1/charts/destroy/\".concat(id),\n      headers: {\n        \"X-CSRF-Token\": token,\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(function () {\n      props.getCharts();\n    })[\"catch\"](function (err) {\n      console.log(err);\n    });\n  };\n\n  var chartList;\n\n  if (props.props.charts) {\n    chartList = props.props.charts.map(function (chart) {\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: chart.id,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 17\n        }\n      }, chart.caption, \" \", props.props.sessionId === chart.user_id ? /*#__PURE__*/React.createElement(\"button\", {\n        onClick: function onClick(e) {\n          return deleteChart(e, chart.id);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 25\n        }\n      }, \"delete\") : null), /*#__PURE__*/React.createElement(\"td\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 17\n        }\n      }, moment(chart.created_at).format(\"DD/MM/YYYY, h:mm a\")), /*#__PURE__*/React.createElement(\"td\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"\".concat(chart.chart.url),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 21\n        }\n      }, fileName(chart.chart.url))));\n    });\n  }\n\n  ;\n  return /*#__PURE__*/React.createElement(CardWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }\n  }, props.isLoading || props.charts && props.charts.length === 0 ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 17\n    }\n  }, \"No charts added yet\") : /*#__PURE__*/React.createElement(ChartTable, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    condensed: \"true\",\n    striped: true,\n    bordered: true,\n    hover: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 33\n    }\n  }, \"Name\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 33\n    }\n  }, \"Posted At\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 33\n    }\n  }, \"Download Link (right click, click 'save as')\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 25\n    }\n  }, chartList))));\n}\n\nvar Form = /*#__PURE__*/function (_Component) {\n  _inherits(Form, _Component);\n\n  var _super = _createSuper(Form);\n\n  function Form() {\n    var _this2;\n\n    _classCallCheck(this, Form);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this2 = _super.call.apply(_super, [this].concat(args));\n    _this2.state = {\n      sessionId: null,\n      caption: \"\",\n      chart: null,\n      uploading: false,\n      errorMessage: null\n    };\n\n    _this2.onChange = function (e) {\n      _this2.setState(_defineProperty({}, e.target.name, e.target.value));\n    };\n\n    _this2.chartUpload = function (e) {\n      _this2.setState({\n        chart: e.target.files[0]\n      });\n    };\n\n    _this2.onSubmit = function (e) {\n      e.preventDefault();\n\n      _this2.setState({\n        uploading: true\n      });\n\n      var token = document.querySelector('meta[name=\"csrf-token\"]').content;\n      var body = new FormData();\n      body.append('chart', _this2.state.chart);\n      body.append('caption', _this2.state.caption);\n      body.append('user_id', _this2.props.userId);\n      fetch('/api/v1/charts', {\n        method: \"POST\",\n        headers: {\n          \"X-CSRF-Token\": token\n        },\n        body: body\n      }).then(function (res) {\n        _this2.setState({\n          uploading: false\n        });\n\n        if (res.ok) {\n          return res.json();\n        } else {\n          _this2.setState({\n            errorMessage: 'Failed to post'\n          });\n        }\n      }).then(function () {\n        _this2.props.getCharts();\n      });\n    };\n\n    return _this2;\n  }\n\n  _createClass(Form, [{\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(ChartForm, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"form\", {\n        onSubmit: this.onSubmit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(FormGroup, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(FormControl, {\n        type: \"text\",\n        value: this.state.value,\n        name: \"caption\",\n        placeholder: \"caption\",\n        onChange: this.onChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(Validator, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 25\n        }\n      }, \"Accepted file extensions: .gpx, .shp, .zip\"), /*#__PURE__*/React.createElement(FormControl, {\n        type: \"file\",\n        onChange: this.chartUpload,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"button\", {\n        variant: \"text\",\n        type: \"submit\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 21\n        }\n      }, \"Submit\")));\n    }\n  }]);\n\n  return Form;\n}(Component);\n\nexport var Index = /*#__PURE__*/function (_Component2) {\n  _inherits(Index, _Component2);\n\n  var _super2 = _createSuper(Index);\n\n  function Index() {\n    var _this3;\n\n    _classCallCheck(this, Index);\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    _this3 = _super2.call.apply(_super2, [this].concat(args));\n    _this3.state = {\n      isLoading: false,\n      charts: [],\n      errorMessage: null,\n      sessionId: null\n    };\n    return _this3;\n  }\n\n  _createClass(Index, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getCharts();\n    }\n  }, {\n    key: \"getCharts\",\n    value: function getCharts() {\n      var _this4 = this;\n\n      this.setState({\n        isLoading: true,\n        sessionId: this.props.userId\n      });\n      axios.get('/api/v1/charts').then(function (res) {\n        _this4.setState({\n          charts: res.data,\n          isLoading: false\n        });\n      })[\"catch\"](function (err) {\n        _this4.setState({\n          errorMessage: \"We're having trouble finding charts for your request. Please try again later\",\n          isLoading: false\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"reactPageAppContainer\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Breadcrumb, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Breadcrumb.Item, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Link, {\n        to: \"/\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 38\n        }\n      }, \"Home\")), /*#__PURE__*/React.createElement(Breadcrumb.Item, {\n        active: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 21\n        }\n      }, \"Charts\")), /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 17\n        }\n      }, \"Charts\"), /*#__PURE__*/React.createElement(Form, {\n        user_id: this.state.sessionId,\n        getCharts: this.getCharts.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 17\n        }\n      }), this.state.loading ? /*#__PURE__*/React.createElement(BarLoader, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 25\n        }\n      }) : /*#__PURE__*/React.createElement(ChartList, {\n        getCharts: this.getCharts.bind(this),\n        props: this.state,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 25\n        }\n      }));\n    }\n  }]);\n\n  return Index;\n}(Component);\nexport default Index;","map":{"version":3,"sources":["/Users/diehl/Documents/Projects/icfc/app/javascript/src/components/charts/Index.js"],"names":["React","Component","Breadcrumb","Table","FormControl","FormGroup","styled","BarLoader","Link","moment","axios","CardWrapper","div","ChartForm","ChartTable","Validator","span","ChartList","props","fileName","url","split","slice","token","document","querySelector","content","deleteChart","e","id","preventDefault","method","headers","then","getCharts","err","console","log","chartList","charts","map","chart","caption","sessionId","user_id","created_at","format","isLoading","length","Form","state","uploading","errorMessage","onChange","setState","target","name","value","chartUpload","files","onSubmit","body","FormData","append","userId","fetch","res","ok","json","Index","get","data","bind","loading"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { Breadcrumb, Table, FormControl, FormGroup, Button } from 'react-bootstrap';\nimport styled from 'styled-components';\nimport BarLoader from 'react-spinners/BarLoader';\nimport { Link } from 'react-router-dom';\n\nimport * as moment from 'moment';\nimport * as axios from 'axios';\n\nconst CardWrapper = styled.div`\n`;\n\nconst ChartForm = styled.div`\n    margin: 0 auto;\n    padding: 0px 33%;\n`;\n\nconst ChartTable = styled.div`\n    margin-top: 12px;\n`;\n\nconst Validator = styled.span`\n    text-size: 8px;\n    margin: 7px;\n`;\n\nfunction ChartList(props) {\n    const fileName = url => {\n        return url.split('/').slice(-1)[0];\n    }\n    const token = document.querySelector('meta[name=\"csrf-token\"]').content;\n    const deleteChart = (e, id) => {\n        e.preventDefault();\n        axios({\n            method: 'delete',\n            url: `/api/v1/charts/destroy/${id}`,\n            headers: {\n                \"X-CSRF-Token\": token,\n                \"Content-Type\": \"application/json\"\n            }\n        }).then(() => {\n            props.getCharts();\n        })\n        .catch(err => {\n            console.log(err);\n        });\n    }\n    let chartList;\n    if (props.props.charts) {\n        chartList = props.props.charts.map(chart =>\n            <tr key={chart.id}>\n                <td>{chart.caption} {\n                    props.props.sessionId === chart.user_id ? (\n                        <button onClick={e => deleteChart(e, chart.id)}>delete</button>\n                    ) : null\n                }</td>\n                <td>{moment(chart.created_at).format(\"DD/MM/YYYY, h:mm a\")}</td>\n                <td><a href={`${chart.chart.url}`}>{fileName(chart.chart.url)}</a></td>\n            </tr>\n        );\n    };\n    return (\n        <CardWrapper>\n            { props.isLoading || ( props.charts && props.charts.length === 0 ) ? (\n                <p>No charts added yet</p>\n            ) : (\n                <ChartTable>\n                    <Table condensed=\"true\" striped bordered hover>\n                        <thead>\n                            <tr>\n                                <th>Name</th>\n                                <th>Posted At</th>\n                                <th>Download Link (right click, click 'save as')</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {chartList}\n                        </tbody>\n                    </Table>\n                </ChartTable>\n            )}\n        </CardWrapper>\n    );\n}\n\nclass Form extends Component {\n    state = {\n        sessionId: null,\n        caption: \"\",\n        chart: null,\n        uploading: false,\n        errorMessage: null\n    }\n\n    onChange = e => {\n        this.setState({[e.target.name]: e.target.value })\n    }\n\n    chartUpload = e => {\n        this.setState({chart: e.target.files[0]})\n    }\n\n    onSubmit = e => {\n        e.preventDefault();\n        this.setState({\n            uploading: true\n        });\n        const token = document.querySelector('meta[name=\"csrf-token\"]').content;\n        let body = new FormData();\n        body.append('chart', this.state.chart);\n        body.append('caption', this.state.caption);\n        body.append('user_id', this.props.userId);\n        fetch('/api/v1/charts', {\n            method: \"POST\",\n            headers: {\n                \"X-CSRF-Token\": token\n            },\n            body: body\n        })\n        .then(res => {\n            this.setState({uploading: false});\n            if (res.ok) {\n                return res.json();\n            } else {\n                this.setState({errorMessage: 'Failed to post'});\n            }\n        })\n        .then(() => {\n            this.props.getCharts();\n        });\n    }\n\n    render() {\n        return (\n            <ChartForm>\n                <form onSubmit={this.onSubmit}>\n                    <FormGroup>\n                        <FormControl\n                            type=\"text\"\n                            value={this.state.value}\n                            name=\"caption\"\n                            placeholder=\"caption\"\n                            onChange={this.onChange}\n                        />\n                        <Validator>Accepted file extensions: .gpx, .shp, .zip</Validator>\n                        <FormControl\n                            type=\"file\"\n                            onChange={this.chartUpload}\n                        />\n                    </FormGroup>\n                    <button variant=\"text\" type=\"submit\">\n                        Submit\n                    </button>\n                </form>\n            </ChartForm>\n        )\n    }\n}\n\nexport class Index extends Component {\n    state = {\n        isLoading: false,\n        charts: [],\n        errorMessage: null,\n        sessionId: null\n    }\n\n    componentDidMount() {\n        this.getCharts();\n    }\n\n    getCharts() {\n        this.setState({\n            isLoading: true,\n            sessionId: this.props.userId\n        });\n        axios.get('/api/v1/charts')\n        .then(res => {\n            this.setState({\n                charts: res.data,\n                isLoading: false\n            });\n        })\n        .catch(err => {\n            this.setState({\n                errorMessage: \"We're having trouble finding charts for your request. Please try again later\",\n                isLoading: false\n            });\n        });\n    }\n\n    render() {\n        return (\n            <div className=\"reactPageAppContainer\">\n                <Breadcrumb>\n                    <Breadcrumb.Item><Link to=\"/\">Home</Link></Breadcrumb.Item>\n                    <Breadcrumb.Item active>Charts</Breadcrumb.Item>\n                </Breadcrumb>\n                {/* <h1>Family Trees</h1>\n                <p>Please find the link to the shared google drive below. Feel free to share your family's tree there using templates provided by Sophia Crawford.</p>\n                <Button><Link href=\"https://drive.google.com/drive/folders/10dEUl82hW_-4PH_enwEUKngWz3HAjzys\">Family Trees</Link></Button> */}\n                <h1>Charts</h1>\n                <Form \n                    user_id={this.state.sessionId}\n                    getCharts={this.getCharts.bind(this)}\n                >    \n                </Form>\n                {\n                    this.state.loading ? (\n                        <BarLoader />\n                    ) : (\n                        <ChartList\n                            getCharts={this.getCharts.bind(this)}\n                            props={this.state} \n                        />\n                    )\n                }\n            </div>\n        )\n    }\n}\n\nexport default Index;"]},"metadata":{},"sourceType":"module"}